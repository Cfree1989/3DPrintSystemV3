<div class="card-v0 job-card-v0 {% if job.staff_viewed_at is none %}card-v0-unreviewed{% endif %}" 
     data-job-id="{{ job.id }}">
    {% if job.staff_viewed_at is none %}
    <div class="flex items-center mb-v0-lg">
        <span class="badge-v0-new">NEW</span>
    </div>
    {% endif %}
    <div class="job-card-content-v0">
        <div class="flex items-start justify-between">
            <!-- Student Information (Primary) -->
            <div class="flex-1 min-w-0">
                <h3 class="text-v0-job-title mb-v0-xs">{{ job.student_name }}</h3>
                <p class="text-v0-body mb-v0-md">{{ job.display_name or job.original_filename }}</p>
                <div class="grid-v0-details text-v0-detail">
                    <span>{{ job.student_email }}</span>
                    <span>{{ job.discipline | discipline_name }}</span>
                    {% if job.class_number %}
                    <span>{{ job.class_number }}</span>
                    {% endif %}
                </div>
            </div>

            <!-- Job Details (Secondary) -->
            <div class="ml-v0-xl text-right">
                <div class="text-v0-detail mb-v0-base">
                    <span class="job-age" data-created-at="{{ job.created_at.isoformat() if job.created_at }}"></span>
                </div>
                {% if job.printer or job.color or job.material %}
                <div class="text-v0-sm space-y-v0-xs text-right">
                    {% if job.printer %}
                    <div class="text-v0-body font-medium">{{ job.printer | printer_name }}</div>
                    {% endif %}
                    {% if job.color %}
                    <div class="text-v0-detail">{{ job.color | color_name }}</div>
                    {% endif %}
                    {% if job.material %}
                    <div class="text-v0-detail">{{ job.material | title }}</div>
                    {% endif %}
                </div>
                {% endif %}
                {% if job.cost_usd %}
                <div class="text-v0-lg font-semibold text-v0-primary mt-v0-md">
                    ${{ "%.2f"|format(job.cost_usd) }}
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- V0.dev Action Buttons -->
    {% if current_status == 'UPLOADED' %}
    <div class="job-card-actions-v0 border-t border-v0-border">
        <div class="flex items-center justify-between">
            <!-- Primary Actions (Left) -->
            <div class="button-group-v0">
                <button onclick="handleApprovalClick(event, '{{ job.id }}')" 
                        class="btn-v0-success">
                    Approve
                </button>
                <button onclick="handleRejectionClick(event, '{{ job.id }}')"
                        class="btn-v0-danger">
                    Reject
                </button>
                <button onclick="event.stopPropagation(); event.preventDefault();" class="btn-v0-secondary">
                    üìã View Details
                </button>
            </div>
            
            <!-- Review Status Actions (Right) -->
            <div class="flex items-center gap-v0-base">
                {% if job.staff_viewed_at is none %}
                <!-- Unreviewed State -->
                <span class="text-v0-badge text-v0-orange-600 font-medium">Unreviewed</span>
                <div class="relative">
                    <button onclick="showReviewMenu('{{ job.id }}')" 
                            class="btn-v0-warning text-v0-badge"
                            title="Review options">
                        Review
                    </button>
                    <div id="review-menu-{{ job.id }}" class="hidden absolute right-0 mt-1 w-48 card-v0 z-10">
                        <button onclick="confirmMarkAsReviewed('{{ job.id }}')" 
                                class="w-full text-left p-v0-base text-v0-body hover:bg-v0-gray-50 rounded-t-lg
                                       focus:outline-none focus:bg-v0-gray-50">
                            ‚úì Mark as Reviewed
                        </button>
                    </div>
                </div>
                {% else %}
                <!-- Reviewed State -->
                <span class="text-v0-badge text-v0-green-600 font-medium">Reviewed</span>
                <div class="relative">
                    <button onclick="showReviewMenu('{{ job.id }}')" 
                            class="btn-v0-success text-v0-badge"
                            title="Review options">
                        ‚öôÔ∏è Review
                    </button>
                    <div id="review-menu-{{ job.id }}" class="hidden absolute right-0 mt-1 w-48 card-v0 z-10">
                        <button onclick="confirmMarkAsUnreviewed('{{ job.id }}')" 
                                class="w-full text-left p-v0-base text-v0-body hover:bg-v0-gray-50 rounded-t-lg
                                       focus:outline-none focus:bg-v0-gray-50">
                            ‚Ü∫ Mark as Unreviewed
                        </button>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% endif %}
</div> 